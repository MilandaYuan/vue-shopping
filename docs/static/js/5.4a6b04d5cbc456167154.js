webpackJsonp([5],{k651:function(t,e){},tcnj:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("Gu7T"),r=o.n(n),a=o("Xxa5"),s=o.n(a),i=o("exGp"),c=o.n(i),u=o("UeVD"),v=o("gyMJ"),f=(o("Cpzh"),{name:"list",filters:{toFixed:function(t,e){return"￥"+t.toFixed(e)}},created:function(){this.getData()},data:function(){return{books:[],offset:0,hasMore:!0,isLoading:!1}},mounted:function(){var t=this,e=this.$refs.scroll,o=e.offsetTop,n=void 0,r=!1;e.addEventListener("touchstart",function(a){if(e.offsetTop===o&&0===e.scrollTop){var s=a.touches[0].pageY,i=function t(a){r=!0;var i=a.touches[0].pageY;(n=i-s)>0?n<=50?e.style.top=o+n+"px":(n=50,e.style.top=50+o+"px"):(e.removeEventListener("touchmove",t),e.removeEventListener("touchend",c))},c=function a(s){r&&(t.timerUp=setInterval(function(){if(n<=0)return clearInterval(t.timerUp),n=0,e.removeEventListener("touchmove",i),e.removeEventListener("touchend",a),t.books=[],t.hasMore=!0,t.offset=0,void t.getData();n-=1,e.style.top=o+n+"px"},1))};e.addEventListener("touchmove",i),e.addEventListener("touchend",c)}})},methods:{addToCart:function(t){this.$store.dispatch("increaseCount",t)},loadMore:function(){var t=this;return c()(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:clearTimeout(t.timer),t.timer=setTimeout(function(){var e=t.$refs.scroll;e.scrollTop+e.clientHeight+20>e.scrollHeight&&t.getData()},60);case 2:case"end":return e.stop()}},e,t)}))()},getData:function(){var t=this;return c()(s.a.mark(function e(){var o,n,a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.hasMore||t.isLoading){e.next=11;break}return t.isLoading=!0,e.next=4,Object(v.g)(t.offset);case 4:o=e.sent,n=o.hasMore,a=o.books,t.hasMore=n,t.books=[].concat(r()(t.books),r()(a)),t.offset=t.books.length,t.isLoading=!1;case 11:case"end":return e.stop()}},e,t)}))()},remove:function(t){var e=this;return c()(s.a.mark(function o(){return s.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Object(v.h)(t);case 2:e.books=e.books.filter(function(e){return e.bookId!==t});case 3:case"end":return o.stop()}},o,e)}))()}},components:{MHeader:u.a}}),d={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("MHeader",[t._v("列表")]),t._v(" "),o("div",{ref:"scroll",staticClass:"content",on:{scroll:t.loadMore}},[o("ul",t._l(t.books,function(e,n){return o("router-link",{key:n,attrs:{to:{name:"detail",params:{bid:e.bookId}},tag:"li"}},[o("div",{staticClass:"img-container"},[o("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.bookCover,expression:"book.bookCover"}],attrs:{alt:""}})]),t._v(" "),o("div",{staticClass:"info-container"},[o("h3",[t._v(t._s(e.bookName))]),t._v(" "),o("p",[t._v(t._s(e.bookInfo))]),t._v(" "),o("b",[t._v(t._s(t._f("toFixed")(e.bookPrice,2)))]),t._v(" "),o("div",[o("button",{staticClass:"button",on:{click:function(o){o.stopPropagation(),t.remove(e.bookId)}}},[t._v("删除")]),t._v(" "),o("button",{staticClass:"button",on:{click:function(o){o.stopPropagation(),t.addToCart(e.bookId)}}},[t._v("添加")])])])])})),t._v(" "),t.hasMore?o("div",{staticClass:"loading",on:{click:t.getData}},[t._v("正在加载...")]):o("div",{staticClass:"no-more"},[t._v("没有啦~~")])])],1)},staticRenderFns:[]};var l=o("VU/8")(f,d,!1,function(t){o("k651")},"data-v-019153e6",null);e.default=l.exports}});
//# sourceMappingURL=5.4a6b04d5cbc456167154.js.map